name: Network Scan

on:
  workflow_dispatch:

jobs:
  scan:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Check firewall rules
        shell: bash
        run: |
          echo "=== Checking iptables rules ==="
          sudo iptables -L -n -v || echo "iptables not available"

          echo "=== Checking nftables rules ==="
          sudo nft list ruleset || echo "nftables not available"

          echo "=== Checking UFW status ==="
          sudo ufw status verbose || echo "ufw not available"

          echo "=== Checking firewalld status ==="
          sudo firewall-cmd --list-all || echo "firewalld not available"

          echo "=== Firewall check complete ==="
      
      - name: Scan UDP and other protocols on 13.83.233.97
        shell: bash
        run: |
          echo "Installing nmap..."
          sudo apt-get update -y
          sudo apt-get install -y nmap
      
          TARGET_IP="13.83.233.97"
      
          echo "=== ICMP Ping Test ==="
          ping -c 4 $TARGET_IP || echo "Ping failed or ICMP blocked"
      
          echo "=== UDP Top Ports Scan ==="
          nmap -sU -Pn --top-ports 200 $TARGET_IP
      
          echo "=== Full UDP Scan (may take a long time) ==="
          nmap -sU -Pn $TARGET_IP
      
          echo "=== SCTP Scan (Stream Control Transmission Protocol) ==="
          nmap -sY -Pn $TARGET_IP
      
          echo "=== Protocol Scan (IP protocol discovery) ==="
          nmap -sO -Pn $TARGET_IP
      
          echo "=== Completed UDP + Protocol Scan ==="

